---
title: "Comparing summed probability distributions of shoreline and radiocarbon dates from the Mesolithic Skagerrak coast of Norway"
# author:
#   - Isak Roalkvam, University of Oslo, Institute of Archaeology, Conservation and History
#   - Steinar Solheim, University of Oslo, Museum of Cultural History
author:
  - Isak Roalkvam:
      email: isak.roalkvam@iakh.uio.no
      institute: [iakh]
      correspondence: true
  - name: Steinar Solheim
    email: steinar.solheim@khm.uio.no
    institute: [mch]
    correspondence: false
institute:
  - iakh: University of Oslo, Department of Archaeology, Conservation and History
  - mch: University of Oslo, Museum of Cultural History
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::pdf_document2:
      fig_caption: true
      toc: false
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - '--lua-filter=../templates/scholarly-metadata.lua'
      - '--lua-filter=../templates/author-info-blocks.lua'
      - '--lua-filter=../templates/pagebreak.lua'
header-includes:
  \usepackage{placeins}
  \usepackage[left]{lineno}
  \linenumbers
# always_allow_html: true
bibliography: references.bib
csl: "../templates/saa.csl" # Insert path for the bib-style
abstract: |
  By developing a new methodology for handling and assessing a large number of shoreline dated sites, this paper compares the summed probability distribution of radiocarbon dates and shoreline dates along the Skagerrak coast of south-eastern Norway. Both measures have previously been compared to elucidate demographic developments in Fennoscandia, but these have not been based on probabilistic methods for shoreline dating. The findings indicate a largely diverging development of the two data sets through the Mesolithic. The number of shoreline dated sites undergoes some process of overall decrease through the period, while the radiocarbon data is characterised by a lacking signal in the earliest parts of the period and then undergoes a logistic growth that quickly plateaus and remains stable for the remainder of the period. The precise nature of this discrepancy will necessitate further substantiation and the method of shoreline dating itself still requires further testing and assessment. Having noted this, we still tentatively suggest that while the number of shoreline dated sites is not devoid of influence from a demographic signal, this measure could be more heavily influenced by mobility patterns. Conversely, we also suggest that the lacking radiocarbon data from the earliest part of the Mesolithic is in part the result of mobility patterns, but that the radiocarbon data more directly reflects population dynamics.
keywords: | 
  Mesolithic; Shoreline dates; Radiocarbon dates; Fennoscandia
---
Keywords: `r rmarkdown::metadata$keywords`

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)

# knitr::opts_knit$set(
#   eval.after = "fig.cap"
# )

# Set-up so that I can call floatbarrier using regfloat=TRUE in the chunk 
# headings. See: 
# https://gist.github.com/burchill/8873d2ade156b27e92a238a774ce2758
knitr::knit_hooks$set(plot = function (x, options) {
  float_correct <- function(f, y, opts)  {
    if (is.null(opts$regfloat) || opts$regfloat==FALSE)
      paste0(f(y, opts), "\n\n\\FloatBarrier\n")
    else
      f(y, opts)
  }
  if (!is.null(options$out.width) || !is.null(options$out.height) ||
      !is.null(options$out.extra) || options$fig.align != "default" ||
      !is.null(options$fig.subcap)) {
    if (is.null(options$fig.scap))
      options$fig.scap = NA
    return(float_correct(knitr:::hook_plot_tex, x, options))
  }
  return(float_correct(knitr:::hook_plot_md_base, x, options))
})
```

```{r packages, echo = FALSE}
library(here)
library(dplyr)
library(ggplot2)
library(patchwork)
library(kableExtra)
library(sf)
library(shoredate)
```

```{r data, include = FALSE}
surveyed <- st_read(here("analysis/data/raw_data/surveyed_sites.gpkg"))
sites <- st_read(here("analysis/data/derived_data/combined_sites.gpkg"))
```


# Introduction
Variations in population patterns are regarded as important drivers and potential outcomes of cultural variation, and are thus of critical importance to our understanding of past human societies [e.g. @french2021; @shennan2000; @shennan2021]. During the last decade, the frequency distribution of radiocarbon dates has become the preferred proxy for archaeologists studying prehistoric population dynamics [@crema2022; @french2021; @shennan2013], owing in part to the fact that radiocarbon dates represent the most temporally and spatially widespread archaeological data available for studying past population densities [@bird2022]. This has also been the case for Norwegian Stone Age archaeology [e.g. @bergsvik2021; @solheim2018; @solheim2020a; @nielsen2019; @nielsen2021; @jorgensen2020b; @lundstrom2023; @persson2018; see also @persson2009]. 

The potentially immense value of insights into past population dynamics, combined with the ubiquity of radiocarbon dates and the relative ease with which these can now be processed within what has been termed a dates-as-data methodology [@rick1987] has undoubtedly contributed to the popularity of the approach. Several limitations and forms of criticism have, however, been directed at these procedures. Some of the objections are of a methodological nature, while others pertain to the underlying logic and the degree to which there is likely to be a constant and direct connection between the frequency of ^14^C-dates and population dynamics [e.g. @attenbrow2015; @carleton2021; @torfing2015; @ward2021]. What appears to be agreed upon by practitioners and critics alike is that radiocarbon dates are best analysed in this manner when compared and contrasted to other proxies for past population dynamics, and other variables that might impact these [@attenbrow2015; @crombe2014; @bevan2017; @french2021; @palmisano2017; @palmisano2021; @williams2012; @rick1987]. In this paper, we report on and begin to unpack the relationship between two measures that have been linked to relative population size in the context of the Mesolithic Skagerrak coast in south-eastern Norway, namely the summed probability distribution of calibrated radiocarbon dates (RSPD) and the summed probability distribution of shoreline dated sites (SSPD). We discuss how the data compare with each other as well as how they can potentially be drawn on to understand cultural historical developments in the region through the Mesolithic, c. 9500--4000 BCE. 

# Background
Following the retreat of the Fennoscandian Ice Sheet, large parts of the post-glacial landscape of Northern Scandinavia has been characterised by dramatic isostatic uplift that has led to a net sea-level fall throughout the Holocene, despite eustatic sea-level rise [e.g. @mörner1979; @steffen2011]. The majority of Mesolithic sites along the Norwegian Skagerak coast are interpreted as having been shore bound or located close to the contemporaneous shoreline at their time of use. Thus, as coastal foragers in this region appear to have predominantly settled on or close to the contemporaneous shoreline during early and mid-Holocene, this can be utilised to assign an approximate date to the sites. This is done by coupling the present-day altitude of the sites with reconstructions of past shoreline displacement -- a method known as shoreline dating. Shoreline dating has a long tradition of use in Fennoscandian archaeology [@brogger1905; @hollender1901], and is especially useful for dating the large number of surveyed archaeological sites where temporal data that often follow with an excavation, such as radiocarbon dates or typological indicators in artefact inventories, are not available. A series of studies have suggested that shoreline dated sites can be used as a proxy to study temporal variation in population density [@jorgensen2020; @mjærum2022; @solheim2018; @tallavaara2020].

Previously, the frequency of shoreline dated sites has been evaluated by finding point estimates of shoreline dates that are aggregated in somewhat arbitrary bins of 200 or 500 years [e.g. @fossum2020; @solheim2018; @mjærum2022; @tallavaara2020], or by the use of disjoint time-intervals of variable duration [@berg-hansen2022], which could cause issues when comparing the relative counts across these units [@bevan2021]. However, the point-based estimates do not consider the uncertainty in the distance between the sites and the contemporaneous shoreline, nor the impact the variability in the rate of sea-level change has on the precision of the dates that can be achieved with the method. In a recent study, @roalkvam2023 has presented a probabilistic method for shoreline dating that takes these parameters into account, thus setting the stage for a more refined investigation of the relationship between the frequency of ^14^C-dates and shoreline dated sites. The parametrisation of the method was based on simulating the distance between 66 sites with ^14^C-dates and the prehistoric shoreline along the Skagerrak coast in the region between Horten municipality in the north-east to Arendal municipality in the south-west (see map in Figure \@ref(fig:map)). The result of the analysis indicates that the sites tend to have been located close to the shoreline until just after 4000 BCE when a few sites become more withdrawn from the shoreline [see also @nielsen2021a], followed by a clear break around 2500 BCE, at which point shoreline dating appears to lose its utility. Thus, this geographical and temporal limit are also used for this study. 

The present study is decidedly exploratory. While some thoughts concerning the relationship between the variables underlie the analysis, these could not be instantiated as concrete hypotheses. Rather, we explore the data by using a set of standard models to begin to unpack patterns and grasp the relationship between the variables. The dates-as-data approach is dependent on there being a link between how prehistoric people generated material that become ^14^C samples and population dynamics. The sum of shoreline dated sites, on the other hand, is determined by site frequency, and its use as a population proxy is therefore dependent on there being a connection between site count and population density. If a comparison of these proxies indicate that they do not, or only partially correspond, it is thus an open question what factors have impacted either distribution to cause this discrepancy, and which measure, if any, reflects true population dynamics. The issue will therefore initially demand an open and exploratory approach where a multitude of explanatory and confounding effects can be drawn on to suggest explanations of any observed pattern. 

## Population dynamics and summed probabilities

To what degree the radiocarbon record is determined by past population numbers might vary geographically and chronologically, based on variation in investigatory and taphonomic factors [@surovell2009b; @bluhm2019], as well as cultural processes within prehistoric populations. One example of the latter is the difference that might exist between farmer and forager populations, where @freeman2018 have suggested that an increased per capita energy consumption introduced with farming means that ^14^C-dates should not be weighted equally when making relative population estimates across such populations. Similarly, while site counts have also been invoked for the analysis of past population dynamics, these are likely to be impacted by factors such as land-use and mobility patterns, and settlement nucleation and dispersion, as well as variation in archaeological investigations and what has been taken to constitute a site [@drennan2015, 16--20; @palmisano2017]. However, these could be considered theoretical issues that have implications for how fluctuations in these proxies should be interpreted, and possibly weighted differently by factors such as those mentioned above. Before any such fluctuations are given any substantive interpretation, however, there is a host of methodological issues that have to be considered [see @crema2022 for a recent review].

The most critical of these follows from the fact that the summation of the probabilities associated with the dates for SPDs is not a directly coherent statistical procedure. This is because the summed probabilities can no longer been seen as probabilities, but rather represent the combination of events and chronological uncertainties, making the two indistinguishable, and rendering the interpretation of the resulting sum difficult [@blackwell2003; @crema2022]. As @timpson2021[2] put it: 'the SPD is not *the* single best explanation of the data, nor even *a* single explanation of the data, but rather a conflation of many possible explanations simultaneously, each of which is mired by the artefacts inherited from the calibration wiggles.' The SPD is not a model. It is the combined representation of a range of possible explanations for the data -- the frequency of dated events combined with the variable uncertainty associated with these [@carleton2021]. This means that a direct visual inspection of SPDs can be misleading, that they cannot be directly analysed to draw inferences on population dynamics, and that they cannot be directly compared to other time-series data [@carleton2018; @timpson2021; @crema2022]. While this problem cannot be entirely resolved, a range of approaches have been developed in an attempt to work around this issue.

The most commonly applied of these is a null-hypothesis significance testing approach by means of Monte Carlo simulation, first introduced by @shennan2013 and later expanded upon by @timpson2014 and @crema2021. This works by comparing the observed RSPD with a series of simulated RSPDs, generated from a null model. These null models are typically a uniform, exponential or logistic distribution. These are generally chosen *a priori* with reference to common long-term population dynamics and are typically parametrised by fitting the models by means of least-squares or, given recent methodological developments [@timpson2021], maximum likelihood estimation (MLE). The result from these simulations is then used to create a 95% critical envelope representing the null model. The proportion of the observed RSPD that falls outside the simulated envelope (i.e. positive or negative divergence of the observed SPD from the fitted null model), is then used to estimate a global p-value indicating whether the null model can be rejected. In the case that it can, the portions of the observed RSPD that falls outside this envelope can subsequently be interpreted as representing potentially meaningful demographic events, relative to the null model. However, care has to be taken in how these are interpreted. First, this follows from the fact that 5% of the deviations from the critical envelope can be expected to be random, and there is no way to know which deviations this pertains to. Secondly, for example, an exponential null model fit to the data is only one of an infinite set of exponential models with different growth rates that could be used. While a model fit by means of MLE will likely have a reasonable growth rate, and by extension exclude many other exponential fits as likely to explain the data, this can be difficult to determine. Finally, the p-value only indicates whether the null model as a whole can be rejected as an explanation of the data, and it does not provide statistical justification for inferring whether local deviations themselves are meaningful demographic signals [@crema2022; @timpson2021].

The procedure outlined above represent the standard approach in efforts to model population dynamics based on RSPDs. This can be helpful for getting an impression of the overall developments of population proxies, and it is an especially useful first step in the treatment of shoreline dated sites, as few assumptions concerning this overall development could be made. However, it is worth underscoring that deviations from these rejected null models do not in themselves give statistical justification for the interpretation of any local deviations, nor a subsequent direct analysis of the SPDs themselves.

# Methods and data

Sites surveyed by means of test-pitting between Horten and Arendal were initially retrieved from the national heritage database Askeladden [@directorate2018], totalling at `r nrow(surveyed)` records. The records were then manually reviewed and given a quality score based on the criteria in Table \@ref(tab:tab1), indicating the degree to which the spatial location and extent of the sites is believed to be represented by the geometries available in the database [see also @roalkvam2020]. All sites with a quality score of 4 or worse were excluded from further analysis. Any sites situated at elevations that would result in a shoreline date earlier than 9465 BCE were then excluded. This marks the latest start-date among the employed displacement curves, and no sites in the region have yet been conclusively verified to have an older date than around 9300 BCE [@glorstad2016]. Data on excavated sites was originally compiled for @roalkvam2023 and has been compared with site data as listed in @damlien2021 and @nielsen2019. Only excavated sites with available spatial data in Askeladden or local databases at the Museum of Cultural History of the University of Oslo were included in the analysis. The 102 excavated sites in the dataset without relevant ^14^C-dates that were originally shoreline dated in the excavation reports were included in the SSPD along with the retained surveyed sites. This gave a total of 921 shoreline dated sites in the final SSPD. 

The borders of the municipalities within which the shoreline dated sites are located were used to limit the radiocarbon sample. Radiocarbon dates were taken from @roalkvam2023 and an unpublished data set collated by Solheim and Kjetil Loftsgarden for the Museum of Cultural History. Dates done on food crusts were then excluded due the issue of marine reservoir effects [@nielsen2019, 83]. Following both from the point made by @freeman2018 concerning the comparison of radiocarbon dates from populations with different economic modes, as noted above, and from the fact that shoreline dating appears less reliable after 4000 BCE and appears to lose its utility c. 2500 BCE, the Mesolithic is the main focus of this analysis. Consequently, probabilities falling later than 2500 BCE were excluded from the analysis, leading to a final sample of 310 ^14^C-dates. Probabilities falling after 4000 BCE, and the first possible small-scale introduction of agriculture in south-eastern Norway, were retained to account for edge-effects but these results should be treated with care for the reasons noted above. 

All analyses done in this study were performed using the R programming language [@rcoreteam]. Underlying data and programming code used for the paper is available in an online repository at https://doi.org/10.5281/zenodo.10449324. This is structured as a research compendium following @marwick2018b, to allow for reproducibility of the results [see also @Marwick2017]. Analysis of the ^14^C-dates was done using the R packages *ADMUR* v1.0.3 [@timpson2021] and *rcarbon* v1.4.4 [@crema2021]. The R package *shoredate* v1.0.2 was used for performing and handling the shoreline dating of sites [@roalkvam2023b], with re-purposed code from both *ADMUR* and *rcarbon* for subsequent Monte Carlo simulation and model comparison.

```{r tab1}
Quality <- c(1, 2, 3, 4, 5, 6)
Definition <- c("Site delineated by use of a GNSS-device, or a securely georeferenced record. Extensive database entry.", "Secure spatial data. Slight disturbance of the site or somewhat lacking database record.", "Secure spatial data. Damaged site, such as outskirts of a quarry, and/or very limited database entry.", "Surveyed by archaeologists. Database entry is extremely limited/unclear, the site geometry is only given\\\\as a point or small automatically generated circle, and/or finds are from the topsoil of a field.", "Likely site but uncertain spatial information. Typical example is recurring stray finds in a field or other larger area.", "Single stray find or unverified claims/suggestions of possible site.")
Count <- c(nrow(filter(surveyed, quality == 1)), nrow(filter(surveyed, quality == 2)), nrow(filter(surveyed, quality == 3)), nrow(filter(surveyed, quality == 4)),
           nrow(filter(surveyed, quality == 5)), nrow(filter(surveyed, quality == 6)))

df <- data.frame(Definition, Quality, Count)

kableExtra::kable(df, booktabs = TRUE,
      caption = "Quality scoring of site records of surveyed sites retrieved from the national heritage database Askeladden. The scoring system was first used in Roalkvam (2020).", escape = FALSE) %>% kableExtra::kable_styling(latex_options= c("striped", "scale_down"), stripe_color = "gray!20",)
```

```{r map, echo = FALSE, fig.cap = "A) Map displaying the location of the study area and shoreline dated sites. Black lines indicate the borders between municipalities. The surveyed sites included in the analysis are the ones given a quality score of 3 or higher using the framework in Table 1. B) The distribution of radiocarbon dates employed in the study.", out.width = "500px", fig.align="center", regfloat = TRUE}

# Map prepared in 01_shoreline_spd.R 
knitr::include_graphics(here("analysis/figures/map.png"))
```

## Summed probability of calibrated radiocarbon dates

To account for investigatory bias that can result from variable sampling intensity between sites, the summing of radiocarbon dates with *ADMUR* starts with binning dates from the same sites that fall within 200 uncalibrated ^14^C years of each other when measured from the mean ^14^C age. All dates are then calibrated using a resolution of 5 years and normalised to sum to unity. The RSPDs for each site-phase are summed to achieve the final SPD, which is in turn normalised. All calibrations were performed using the IntCal20 calibration curve [@reimer2020]. 

The final RSPD was subjected to the standard null-hypothesis testing approach through Monte Carlo simulation, as introduced above [see @shennan2013; @timpson2014], by fitting an exponential, logistic and uniform model to the observed RSPD. Following @timpson2021, the model parameters were identified by MLE estimation with *ADMUR*, using the differential evolution optimization algorithm *DEoptimR* [@brest2006]. The Monte Carlo simulations were then performed using the *SPDsimulationTest* function from *ADMUR*. For each model, a series of individual calendar years are drawn from the model distribution, with replacement, the number of which equals the number of bins in the observed RSPD. These are then 'uncalibrated' to a single value on the ^14^C scale and a random error from among the observed errors is added to the date. These are then calibrated back to the calendar scale and finally summed. Here, this procedure was repeated 10,000 times for each null model. The 2.5th and 97.5th percentile of the resulting summed probability for each year across all simulations are then retrieved to create the 95% critical envelope with which to compare the observed RSPD. The degree to which the observed RSPD deviates from the simulations is used to calculate a global p-value, indicating whether the null model under consideration can be rejected. 

## Summed probability of shoreline dated sites

Summing the probability of the shoreline dated sites and the model-fitting procedures followed the same structure as that for radiocarbon dates and was partly based on re-purposed programming code from *rcarbon* and *ADMUR*. However, idiosyncrasies in the dating method did necessitate some adjustments. To illustrate this, the procedure for shoreline dating a single site, as suggested in @roalkvam2023, is provided in Figure \@ref(fig:shoredate) and outlined below. 

Four geological reconstructions of shoreline displacement in the region lays the foundation for the method as implemented here (Figure \@ref(fig:shoredate)B). These shoreline displacement curves are from Horten [@romundset2021], Porsgrunn [@sørensen2014; @sørensen2014b; @sorensen2023], Tvedestrand [@romundset2018; @romundset2018b] and Arendal [@romundset2018b], each associated with a shoreline isobase along which the trajectory of relative sea-level (RSL) change has been the same [see @svendsen1987, and map in Figure \@ref(fig:shoredate)A]. The first step in the dating procedure is to interpolate the shoreline displacement to the site to be dated. This is done by inverse distance weighting [e.g. @conolly2020], where the RSL change is interpolated to the location of an archaeological site based on its distance from the isobases of the geological displacement curves. 

```{r tpq_ranges, include = FALSE}
# Load data from mean_tpq_ranges to be used in paragraph below
load(here("analysis/data/derived_data/disp_tpq_ranges.RData"))
```

With an estimated trajectory of shoreline displacement at the site to be dated, the elevation of the site can be drawn on to find a likely date for when it was in use, under the assumption that it was in use when located on or close to the shoreline. Figure \@ref(fig:shoredate)C indicates where the mean elevation of the polygon representing the example site intersects the interpolated displacement curve. As it can reasonably be assumed that a site was not in use when located under water, this effectively represents a *terminus post quem* (TPQ) date. However, TPQ dates that do not account for the likely distance between site and sea when the site was in use limits the further inferential steps that can be taken. Furthermore, the common practice of adding a constant error or binning point-estimates of shoreline dates, as mentioned above, does not consider that the rate of shoreline displacement varies both spatially and temporally, and therefore introduces bias to the result on both the spatial and temporal scale, while also overestimating the precision of the method in most cases. 

This last point can be illustrated by finding the range between the upper and the lower limit of the four geological displacement curves for every meter from the marine limit and down to elevations that do not give an earliest date younger than 2500 BCE. This gives a mean TPQ range of `r round(tpqmean)` years with a standard deviation of `r round(tpqsd)` years across all four displacement curves, with this range varying significantly over time and between curves.

The analysis in @roalkvam2023 found that site phases ^14^C-dated to before 2500 BCE have a likely elevation above sea-level that can be reasonably approximated by a gamma distribution with shape =  0.286 and scale = 20.833. This is incorporated in the procedure for shoreline dating used for this study (Figure \@ref(fig:shoredate)D). When performing this dating procedure, the gamma distribution is sequentially stepped through and transferred to the calendar scale by uniformly distributing the probability across the years in the range between the lower and upper limit of the interpolated displacement curve. This procedure thus gives the shoreline date of a site when accounting for the likely elevation of the site above sea-level when it was in use [see @roalkvam2023 for details]. Given that the shoreline displacement curves have no inversions and should therefore be commutative [see @weninger2015, 545], each shoreline date is normalised to sum to unity before being summed. To reduce the computational cost of the simulation procedures to follow below, the gamma distribution is here stepped through at increments of 0.1 m and the calendar scale is kept at a resolution of 5 years.

```{r shoredate, echo = FALSE, fig.cap = "A) The location of an example site (Askeladden ID 111967-1) relative to the isobases of the displacement curves.  B) The geologically derived shoreline displacement curves for the region and the curve interpolated to the example site. C) The black line on the y-axis represents the elevation of the site. This crosses the interpolated displacement curve at 7680 and 7490 BCE, which thus in practice gives an estimate of when the location of the site emerged from the sea and represents a \\textit{terminus post quem} date for the site. D) The shoreline dating approach used for this study, where the gamma function on the y-axis describes the likely vertical relationship between the shoreline and the site when it was in use.",  out.width = "500px", fig.align="center", regfloat = TRUE}

knitr::include_graphics(here("analysis/figures/example_shoredate.png"))
```

The implications of different approaches to shoreline dating and summing the results are illustrated in Figure \@ref(fig:sumshore). In Figure \@ref(fig:sumshore)A the sites to be shoreline dated are plotted according to their elevation. Due to the variable rates of shoreline displacement within the study region, the same elevation does not necessarily equate to the same date, and so this does not directly inform us about their temporal distribution. For example, as the trajectory for sea-level regression is more pronounced towards the north-east, the same elevation at a location to the south-west implies a younger date compared to one situated further north-east.

When the frequency distribution of shoreline dates has been investigated in the past, this has typically involved finding point-estimates of dates by either using the mean of the displacement curves, or by taking the mean of the TPQ dates for each site (as illustrated in Figure \@ref(fig:shoredate)C). As outlined above,  these point-estimates are then typically aggregated in bins of 200 or 500 years. This approach is illustrated in Figure \@ref(fig:sumshore)B. The SSPD resulting from using the probabilistic method of shoreline dating, given in Figure \@ref(fig:sumshore)C, demonstrates that accounting for the site-sea relationship gives a substantially different result compared to the more traditional approach, which is indicated by the shifts in the positions of peaks and troughs in the distribution after c. 8000 BCE.

```{r sumshore, echo = FALSE, fig.cap = "A) The distribution of the shoreline dated sites (n = 921) by altitude above present sea-level. The binwidth is 4 m. B) The mean of \\textit{terminus post quem} dates for the sites, plotted with a binsize of 200 years, reflecting the common approach to summing shoreline dates. C) The result of instead summing the probability of the shoreline dates achieved with the method employed here, which accounts for the likely distance between sites and shoreline. The binwidth is 5 years, following the resolution used with the dating procedure.",  out.width = "500px", fig.align="center", regfloat = TRUE}

knitr::include_graphics(here("analysis/figures/summed_examples.png"))
```

In the same way as with an RSPD, the SSPD cannot be directly interpreted as reflecting the intensity of sites over time, due to the summation issues introduced above. Furthermore, similar to how characteristics of the calibration curve can introduce bias to the RSPD, the same is true for the SSPD, where the local trajectory of RSL change effectively functions as the calibration curve for each site. As the shoreline displacement curves are interpolated to the sites based on their location along a south-west/north-east gradient, each site is effectively associated with a unique shoreline displacement curve, provided they are not located on exactly the same isobase. With analogy to the radiocarbon methodology, this would be equivalent to each radiocarbon date being associated with a unique calibration curve. As it would be computationally prohibitive to interpolate the shoreline displacement trajectory for each date to be simulated in the Monte Carlo procedure, one shoreline displacement curve was initially interpolated to the centre of each of a series of 2 km wide line segments running perpendicular to the shoreline gradient between the extremes of the distribution of sites. These intervals were assigned a weight based on how the density of observed sites is distributed among them (Figure \@ref(fig:incpolys)). 

```{r incpolys, echo = FALSE, fig.cap = "A) Density of included surveyed sites and excavated sites dated by means of shoreline dating (n = 921) as distributed across 2 km wide line segments that run perpendicular to the shoreline gradient. B) The displacement curves interpolated to the centre of each segment for use in the Monte Carlo simulations below.", out.width = "500px", fig.align="center", regfloat = TRUE}
knitr::include_graphics(here("analysis/figures/incpolys.png"))
```

The Monte Carlo simulations with the SSPD is based on drawing a sample of calendar dates from the observed date range in the SSPD, equalling the number of shoreline-dated sites, where the probability of drawing any 5-year interval is determined by the null model of choice. This is equivalent to the sampling method *calsample* from *rcarbon* [@crema2021]. Each sampled date is then assigned one of the pre-interpolated displacement curves, the probability of which is weighted by the density of observed sites within each 2 km interval. The calendar date is 'uncalibrated' -- to follow the RSPD terminology -- to an elevation range from which a single elevation value is drawn with uniform probability between the lower and upper limit of the displacement curve at that calendar year, using intervals of 5 cm. As shoreline dating is here done with a gamma distribution with the same parameters across all sites, there is no equivalent of the error term for ^14^C-dates that determine the shape of the Gaussian distribution associated with the ^14^C age. Consequently, the elevation value retrieved by 'uncalibrating' the shoreline date was shoreline dated using the displacement curve for the relevant 2 km interval with the same gamma distribution for all samples. Having dated the number of samples equalling the number of shoreline-dated sites, these were then summed, and the entire process repeated a total of 10,000 times. The 97.5% highest and 2.5% lowest summed probability at each interval of 5 years across all simulations was then retrieved to create the 95% critical envelope, and the global p-value found in the same manner as for the RSPDs. This was done using re-purposed code from *ADMUR*.

## Comparing model performance

For each dating method, the relative performance of the exponential, logistic and uniform models was compared. This was done by finding the overall relative log-likelihoods of the models using the *loglik* function from *ADMUR*. For any given model, this involves finding the scalar product between the probability of each shoreline date against the probability of the null model, and in the case of the ^14^C-dates, each site-phase. The overall model likelihood is the product of these individual probabilities and is not, critically, found by using the values of the final SPD [@crema2022; @timpson2021]. From these likelihoods, the Bayesian (or Schwarz) information criterion (BIC) was then found for each model. This penalises the models for the number of parameters in use to avoid over-fitting, and provides a measure for the relative performance of the models. 

# Results

```{r spdmc, echo = FALSE, fig.cap = "Monte Carlo simulation for shoreline and radiocarbon dates. A) Summed probability of shoreline-dated sites (n = 921) compared to an exponential null model. B) SSPD compared to a logistic null model. C) SSPD compared to a uniform null model. D) Summed probability of calibrated radiocarbon dates (n = 310, bins = 134) compared to an exponential null model. E) RSPD compared to a logistic null model. F) RSPD compared to a uniform null model.", out.width = "500px", fig.align="center", regfloat = TRUE}
knitr::include_graphics(here("analysis/figures/mc.png"))
```
The results of the Monte Carlo simulations are given in Figure \@ref(fig:spdmc), displaying the deviations from the simulation envelopes and the corresponding global p-values. The comparison of the models based on BIC scores is given in Figure \@ref(fig:bic).

For the RSPD, the logistic model achieved a p-value of 0.072 and could therefore not be rejected (Figure \@ref(fig:spdmc)E). As is also indicated by the BIC values of the compared models, the logistic model represents the best explanation of the data, and the failure to reject the model means that the data could be expected under this logistic development. This is characterised by a rapid growth from the start of the RSPD, around 8500 BCE, which plateaus at around 7500 BCE and then remains stable for the remainder of the period. 

All the standard models could be rejected for the SSPD. Of the contrasted models, the BIC values indicate that the exponential model is the best candidate. Its negative direction indicates that some overall process of reduction in the frequency of shoreline-dated sites occurs over time, while the rejection of the model and clear deviations from the exponential pattern indicates that this model does not account for the entire development (Figure \@ref(fig:spdmc)A). Some significant deviations occur with the model over-predicting the frequency of sites in the period from c. 9200--9000 BCE, followed by a significant positive peak just after 9000 BCE, lasting until around 8500 BCE. The process of decline is then interrupted by positive deviations at 7900--7400, and with a smaller deviation around 7000 BCE. This is closely followed by a negative deviation between c. 6800 and 5800 BCE. Finally, a positive deviation occurs again around 5300--5000 BCE. While all of the above deviations should also be viewed with caution, questions concerning the reliability of shoreline dating after 4000 BCE [@roalkvam2023] and the small magnitude of the negative deviations that occur around 3000 BCE means that these are disregarded in the discussion to follow.

```{r bic, echo = FALSE, fig.cap = "Bayesian information criterion for the models fit to the SPDs. Lower values indicate a better model.", out.width = "500px", fig.align="center", regfloat = TRUE}
knitr::include_graphics(here("analysis/figures/bic.png"))
```

# Discussion

Although there are generally few ^14^C-dates from the earliest part of the Mesolithic in Norway [e.g. @åstveit2018; @kleppe2018; @breivik2018a; @solheim2018], it is established that Stone Age sites in southern Norway date to the period from before the earliest ^14^C-dates in the study area for this paper, and at least from as far back as around 9300 BCE [e.g. @damlien2018b; @glorstad2016]. While the SSPD achieved here starts from c. 9500 BCE, the RSPD shows no evidence of human activity until c. 8500 BCE. What has caused the lack of ^14^C-dates from this earliest period has been given many possible explanations through the years. These range from taphonomic loss to diverse environmental and/or cultural factors, such as the use of shrubs or rapidly deteriorating seal blubber as fuel for burning, or a preference for consuming raw, dried or fermented food [see @åstveit2014; @bjerck2017; @damm2022]. A possible lack of reliable access to firewood has also been seen as a possible contributor to this pattern, although evidence for the early presence of forested landscapes, at least in the southern parts of the country, has now rendered this a less favoured hypothesis [@solheim2018; see also @damm2022; @sørensen2014].  To assess the potential influence of taphonomy on the logistic model for the RSPD, we fit a version of the model that accounts for taphonomy, using the workflow from *ADMUR*. As this did not alter the MLE parameters of the model, the results of this exercise have been relegated to the supplementary material. While taphonomic and ecological factors are likely part of the picture, we view it as probable that the rapid growth at the start of RSPD and the magnitude of the SSPD in the period preceding this suggest that cultural and demographic factors are central drivers behind this pattern. 

The considered models also indicate that after the initial jumps of each proxy, some process of decrease in shoreline dated site frequency occurs throughout the Mesolithic, contrasted by a general stationary frequency of ^14^C-dated material. Following from what is generally held to be a reduction in residential mobility from the earliest to the later parts of the Mesolithic [e.g. @bang-andersen2005; @fuglestvedt2018, 16--17; @lindblom1984; @bjerck2008, 103--105], an immediate explanation of this mismatch could be that the SSPD is more heavily impacted by variation in land-use and mobility patterns, while the RSPD mainly reflects population dynamics. 

A common interpretation of the Early Mesolithic in Norway is that the population was small but highly mobile, reflected in large numbers of short-lived sites along the coast [e.g. @bjerck2008; @bjerck2017; @fuglestvedt2012]. This is commonly seen in relation to homogeneous lithic technology over large swathes of the Scandinavian Peninsula in this period, and what is believed to have been a rapid colonisation of the Norwegian coastline [e.g. @bang-andersen2012; @bjerck2009; @fuglestvedt2012]. High mobility has been seen as necessary both to maintain demographic viability among colonising groups, and for it to be possible to maintain this technological uniformity over large areas [@rowley-conwy2017; also discussed by @berg-hansen2018]. The initial peak in the SSPD could thus be congruent with a process of rapid colonisation of the Norwegian coast, coupled with a high degree of mobility, leading to the overall high site-count in the earliest period. The lacking signal in the RSPD for the first settlement period could in this view reflect mobility patterns characterised by short occupational duration and corresponding pyrotechnology based on small, short-lived fires [@damm2022] and low population numbers. 

Following this earliest phase of rapid increase in shoreline dated sites, there is a drop from this initial peak, starting from around 8800 BCE, concluding around 8500 BCE and remaining within the simulation envelope until c. 7900 BCE. It has previously been suggested that a change in mobility patterns starts around 8500--8000 BCE, involving a reduction in residential mobility [e.g. @damlien2018b; @roalkvam2022]. Furthermore, both genetic data and technological analyses of lithic inventories indicate that the initial phase of human colonisation from the south is followed by an influx, and possible mixing of people from the east around the same time [@günther2018; @manninen2021]. If this narrative is coupled with the data observed here, these migratory events could appear to result in a relatively sudden drop in site-count as indicated in the SSPD, which in turn could be related to a change in mobility patterns. The end of this drop also roughly corresponds to the first ^14^C-dates in the RSPD around 8500 BCE, leading to the logistic growth that plateaus in the first centuries after 8000 BCE. The logistic growth in the RSPD reaches its plateau in the same time-interval as a positive deviation in the SSPD from the exponential model -- an increase that was also noted by @berg-hansen2022 -- which could indicate that a demographic signal is reflected in the frequency of shoreline dated sites as well.

Subsequently, the SSPD deviates negatively from the exponential null model from c. 6800 to c. 5800 BCE. This is followed by a positive deviation in the last centuries before 5000 BCE. These developments should possibly be seen in relation to simultaneous developments in the inland areas of southern Norway. The negative deviation in the SSPD appears to correspond to an increase in inland activity, which is to take place in the period from c. 6700--5900 BCE and reach its peak around 6200--6000 BCE [@boaz1999; @selsing2010; @persson2018]. @boaz1999 related this to an economic reorganisation, involving a more focused exploitation of the interior and a reduction in the utilisation of coastal areas. This period is followed by a marked reduction in inland activity, lasting until c. 4500--4000 BCE [@persson2018, 204], the onset of which thus corresponds to the end of the negative deviation in the SSPD at c. 5800 BCE and the positive deviation from c. 5300--5000 BCE. @boaz1999 associated this period of decrease in inland activity to the onset of the classic Nøstvet phase, which is now believed to commence in the middle of the 6th millennium BCE [@reitan2022]. The Nøstvet period is argued to be characterised by an increase in specialised coastal adaptation that also coincides with what @fuglestvedt2018[17] has termed \'the great wave\' of rock art in Norway, starting from around 5700 BCE in south-eastern Norway [@fuglestvedt2018, 42--46; @glorstad2010, 216--233]. The onset of the classic Nøstvet thus roughly corresponds with the positive deviation in the SSPD around the later parts of the 6th millennium BCE. 

A recent study by @manninen2023, which considers a larger inland area of northern Scandinavia than the above-referenced studies, found a corresponding increase in inland activity starting from the earliest parts of the Mesolithic that lasted until c. 6000 BCE. However, after this the population dynamics indicated by the radiocarbon record is found to have been characterised by a cessation of growth, rather than the clear decrease suggested by the regional studies in southern Norway. Consequently, properly relating the developments in the coastal region to inland developments and their relevance to each other will benefit from an integrated approach that also explicitly considers the spatial dimension without invoking predefined analytical regions [see @crema2017].

Following from the divergence between the proxies, assessing the suggested and possibly varying influence of demographic developments and mobility patterns on the measures will remain speculative without drawing on additional variables that can control for such confounding effects. Following from the stationarity of the logistic model of the RSPD after c. 7500 BCE, it is possible that fluctuations in the SSPD reflect variation in mobility patterns that are unrelated to demographic developments. There does appear to be a negative deviation from the logistic null model in the RSPD corresponding to the one in the SSPD just before 6000 BCE. An immediate candidate explanation for this decrease could be the so-called Finse cold event, occurring around 6200 BCE, which has been identified in a range of environmental proxy records from Norway [e.g. @nesje2005; @nesje2009], and which corresponds to the 8.2 ka cal BP cold event evident in North Atlantic climate records more widely [e.g. @alley1997; @alley2005; @seppa2009]. The possible societal relevance of the Finse event for the Norwegian Mesolithic has been discussed extensively [e.g. @breivik2018; @fossum2020; @persson2018]. However, as the logistic model could not be rejected for the RSPD it is inappropriate to interpret any deviations from the Monte Carlo envelope and place any analytical weight on the deviations in the RSPD, at least given the present data. While it is possible that the limited sample of ^14^C-dates has led to an underestimation of this deviation, there is, additionally, no indications in the RSPD of an increased demographic signal in the period just before 5000 BCE that would correspond to the positive deviation in SSPD [see also @solheim2018]. A related point that is also worth making here is that the overall demographic trends that the modelling efforts can hope to identify are likely to have been subject to smaller scale demographic fluctuations that simply cannot be ascertained given the available data and its resolution [@tallavaara2021], and which impacts the comparison of the two proxies following both from the different resolutions of the dating methods and the sample sizes underlying the SPDs.

Given the presence of people and corresponding signal in the SSPD before the start of the RSPD, and the suggested relevance of mobility patterns for the lacking signal in the RSPD in this earliest period, neither proxy is presumably devoid of influence from population density or mobility patterns. This is also given support by the correspondence between the logistic growth in the RSPD and the positive deviation in the SSPD in the first centuries of the 8th millennium BCE. However, properly assessing this relationship and the degree to which it has held constant throughout the period will depend on independent data that track the developments of the other factors that have been suggested to be of relevance to the behaviour of the two proxies.  

It is important to underscore that underpinning the potential relevance of demographic and cultural factors that have been highlighted here is the fact that the implemented method for shoreline dating is hefted with considerable unresolved questions concerning its applicability and reliability, and the degree to which the site-sea relationship has been stationary through the Mesolithic and within the study area. For example, it was in @roalkvam2023 found that the vertical distances between site and sea were associated with a higher uncertainty in the earliest part of the Holocene, due to the rapid shoreline displacement in this period. This uncertainty is not properly accounted for in the implemented method, as the MLE parameters of the gamma distribution in use was found when treating all sites older than 2500 BCE in aggregate. Additionally, the MLE parameters for the gamma distribution are point-estimates that do not account for the underlying sample size used for deriving them. Furthermore, the rapid shoreline displacement in the early Holocene is also a challenge for the geological reconstructions themselves, and there is reason to question whether this is properly accounted for in the compiled time-series for RSL-change in the region [see e.g. @romundset2018; @sørensen2014; cf. @ashe2019]. Although these factors will hamper the traditionally employed TPQ approach even more, there is therefore a danger that the severe right skew of the gamma distribution, combined with the rapid shoreline displacement in the earliest period, leads to an overestimation of the antiquity of the sites and the precision of the earliest dates.       

While the apparent applicability of shoreline dating is a testament to the importance the sea has played for movement, communication and resource exploitation through the Mesolithic in the region, the immediate inland has also seen some use through the Mesolithic in south-eastern Norway [e.g. @brogger1905; @gundersen2013]. However, with one notable exception [@mjærum2018], radiocarbon dates reflecting the use of coastal hinterland sites are associated with a few site features that are otherwise unrelated to typo-chronological indicators in the lithic inventories on the same sites, which are instead associated with an earlier date than the radiocarbon dates. Consequently, these later radiocarbon dates are typically interpreted as either being of a non-anthropogenic nature, or the result of visits of a more ephemeral nature that have succeeded the settlement on the sites [e.g. @breivik2018; @schulke2020; @schulke2023; see also @roalkvam2023] -- potentially reflecting an increase in logistic utilisation of the immediate inland areas in the later stages of the Mesolithic. While this conclusion has been reached by several researchers independently of each other, thus increasing the confidence that shoreline dating captures the date of settlement on the sites, there is still reason to question whether the available radiocarbon record reflects the true use of the hinterland in later periods. If the coastal hinterland has been utilised more actively than what is currently evidenced by the radiocarbon record, the SSPD would be biased towards overestimating the intensity of site frequency in earlier periods.   

Another relevant point to mention here is that the RSL change is effectively built into the Monte Carlo simulations, much in the same way as the Monte Carlo simulation method used with radiocarbon dates account for fluctuations in the calibration curve [e.g. @crema2022]. The simulation envelopes therefore pertain to the frequency of shoreline dated sites that could be expected under the null models, given the distribution of sites in the study area (Figure \@ref(fig:incpolys)A), the corresponding local trajectories of RSL change (Figure \@ref(fig:incpolys)B), and a constant relationship between sites and shoreline described by the gamma function employed for the dating procedure (Figure \@ref(fig:shoredate)D). Beyond uncertainties to do with the dating method itself, and by extension also the generation of the Monte Carlo envelope, it is also conceivable that variation in rates of sea-level change has impacted settlement patterns beyond that which could be directly expected under these null models. An increased movement instantiated by increased rates of RSL change could result in the transition to a settlement pattern involving more frequent moves than that which could be expected under a constant adjustment to the shoreline. If this is the case, the proxy would still reflect the degree of occupational duration, but this could be a response to the rate of RSL change rather than other cultural and societal dimensions such as migratory events or adjustments to other environmental developments. Directly accounting for variation in the rate of sea-level change could thus prove important for properly assessing the substantive implications of the fluctuations in this proxy.

Finally, analogous to investigatory biases that might impact the frequency of radiocarbon dates from certain time-intervals, for example resulting from targeted sampling directed towards certain periods of interest, the distribution of sites over different elevations in the landscape might be influenced by survey practices. In evaluating two larger survey projects within the present study region, @persson2014a and @solheim2017c found that the test-pitting was generally conducted in a comparable degree across elevations, but that altitudes equating to shoreline dates towards the end of the Stone Age might be under-represented [also @solheim2018, 337]. Moving forward, similar investigations conducted in a more comprehensive manner will be important for properly evaluating the impact investigatory factors might have on the distribution of shoreline dated sites over time. This will also benefit from directly accounting for the elevation at which residential and commercial infrastructure development has been undertaken, as this generally dictates where surveys are conducted, while also relating this to the topographic characteristics of the landscape. 

# Conclusion

This paper has presented a new methodology for assembling and assessing the sum of a larger number of shoreline dates. This was done by employing the probabilistic method for shoreline dating presented in @roalkvam2023, and by drawing on analogous procedures in the treatment of the temporal frequency distribution of radiocarbon dates [@crema2022; @timpson2014; @crema2021]. The result of employing this methodology was then compared to radiocarbon dates from within the same area, to begin to assess the relationship between the two data types.

The main results were that the RSPD is consistent with the logistic model fit to the data. This is characterised by a rapid logistic growth from the start of the RSPD around 8500 BCE, which plateaus and remains stationary from the first centuries after 8000 BCE. This is contrasted to the shoreline dates, the development of which were better described by a function of exponential decay. While this indicates that some process of decline in the number of shoreline dated sites has occurred over time, the model was rejected as an adequate description of the SSPD. Some of the deviations from the model were then narratively explored to suggest some possible reasons for these deviations. However, given the lack of a model that adequately describe the data, and the informal treatment of these deviations, these should be viewed as suggestions that represent potential lines for further interrogation. 

While it appears that the SSPD and RSPD are differentially impacted by population density, and, we cautiously suggest, the SSPD is more heavily influenced by land-use and mobility patterns, this suggestion and the nature of the discrepancy between the proxies clearly requires further investigation. This is also relevant for the treatment of RSPDs in Scandinavia more broadly, as we suggested that mobility patterns have relevance for the kind of pyrotechnologies that were utilised in the first period of human occupation in the region, and that the technologies utilised largely explain the absence of radiocarbon dates from this earliest period. The degree and stability with which mobility patterns might have impacted the radiocarbon record from later periods, possibly as mediated by pyrotechnology, remains unclear, and could prove important for properly isolating a demographic signal in the radiocarbon data -- a point that has also been made in other contexts [@crombe2014; @hiscock2016, 219].

Some further lines of inquiry could be to draw on lithic technology and tool-kit diversity as a function of population size and density [e.g. @berg-hansen2018; @collard2013a; @riede2014; @solheim2020], and mobility patterns that can potentially be inferred from the composition of lithic assemblages [e.g. @barton2014; @clark2017; @preston2018; @roalkvam2022], which is potentially also influenced by variable rates of RSL change. In terms of mobility patterns, focus was directed here towards residential movement and occupational duration; but other dimensions relating for example to seasonal and territorial mobility, as reflected in the discussion of inland activity, could also prove to be important. In the same vein, environmental conditions, constraints and developments beyond RSL change also represent a range of factors that can have implications for these dimensions, and will consequently be of future importance to unpack the relationship between the proxies [e.g. @hoebe2023; @manninen2018; @jorgensen2020; @ordonez2022; @lundstrom2023]. To account for the confounding effects these might have, a more principled and comprehensive evaluation of how investigatory practices might impact the SPDs would also be beneficial. While certainly also pertinent for the RSPD, this has generally been considered more extensively for radiocarbon data than for shoreline dated sites. Furthermore, aligning the complex web of causes and effects that these different lines of evidence potentially represent will also benefit from a more direct modelling of the development in the SSPD, rather than simply basing the analysis on deviations from a rejected null model [see @timpson2021]. Finally, mapping and contrasting these developments across a larger region will not only offer a larger sample size, which is especially limited for the ^14^C-data employed here, but could also provide important contextualisation for the observed developments [see e.g. @lundstrom2021; @manninen2023; @solheim2018] and potentially reduce the impact of idiosyncratic investigations that might impact the present SPDs inordinately [see e.g. @crema2022; @hoebe2023; @rick1987]. 

Seeing as the implemented method for shoreline dating was recently developed and has been subjected to limited evaluation and testing, there are still considerable uncertainties and limitations associated with its application. While we believe the approach represents an improvement over previous implementations, the results should therefore be considered a cautions first exploration of the implications of employing a probabilistic method for shoreline dating when evaluating large scale trends in the temporal frequency distribution of coastal sites in the region.

# Declaration of competing interest{-}
The authors have no competing interests to declare.

\newpage

# References 

<div id="refs"></div>

```{r taph, echo = FALSE, fig.cap = "The result of accounting for taphonomic loss in the analysis of the radiocarbon data. A) Comparison of MLE parameters for the logistic population dynamics models when both accounting for and disregarding taphonomy using the ADMUR approach. These are superimposed on the RSPD. As indicated by their perfect overlap, accounting for taphonomy does not impact the MLE parameters. B) The taphonomic component of the logistic model estimated when accounting for taphonomy.", out.width = "500px", fig.align="center", regfloat = TRUE}
knitr::include_graphics(here("analysis/figures/taphonomic.png"))
```

